<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KWITANSI</title>
    <link rel="stylesheet" href="style.css" />
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.datatables.net/v/bs5/jszip-2.5.0/b-2.3.5/b-html5-2.3.5/datatables.min.css" />

    <!-- DataTables CSS -->
    <link href="https://cdn.datatables.net/1.13.4/css/jquery.dataTables.min.css" rel="stylesheet">
    <link href="https://cdn.datatables.net/responsive/2.4.0/css/responsive.dataTables.min.css" rel="stylesheet">
    <!-- FontAwesome for icons -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <!-- Tag link untuk favicon -->
    <link rel="icon" href="https://tse2.mm.bing.net/th?id=OIP.PEzGjWR5KT5_WBfoONYflwHaHZ&pid=Api&P=0&h=180" type="image/x-icon" />
    <!-- Tag meta untuk gambar ketika dibagikan di media sosial -->
    <meta property="og:image" content="https://tse2.mm.bing.net/th?id=OIP.PEzGjWR5KT5_WBfoONYflwHaHZ&pid=Api&P=0&h=180" />
    <style>
        *,

html {
    padding: 0;
    margin: 0;
    box-sizing: border-box;
}
body {
  opacity: 1; /* Pastikan semua elemen di dalam body tidak transparan */
  color: black; /* Atur warna teks menjadi hitam untuk semua elemen teks */
  font-size: 16px; /* Atur ukuran teks global, sesuaikan sesuai kebutuhan */
  font-family: Arial, sans-serif; /* Pilihan font global, sesuaikan sesuai kebutuhan */
}

p, h1, h2, h3, h4, h5, h6, span, td, th {
  opacity: 1; /* Pastikan teks dalam elemen-elemen ini tidak transparan */
  color: black; /* Atur warna teks menjadi hitam */
}
body {
    background-color: #dff1fc;
    font-family: "Segoe UI", sans-serif;
}
        nav {
            background-color: rgb(255, 255, 255);
            display: flex;
            justify-content: space-between;
            padding: 1rem 1rem;
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            align-items: center;
        }

        nav .logo-container {
            display: flex;
            align-items: center;
        }

        nav .logo-container img {
            width: 40px;
            margin-right: 0.5rem;
        }

        nav .logo-container .title {
            font-size: 1rem;
            font-weight: bold;
            color: #191919;
        }

        nav ul {
            display: flex;
            align-items: center;
            gap: 0rem;
            list-style: none;
            padding: 0;
            margin: 0;
            transition: transform 300ms ease;
            position: absolute;
            top: 100%;
            right: 0;
            background-color: rgb(255, 255, 255);
            border: 1px solid #dae40f;
            box-shadow: 0px 4px 6px rgba(252, 248, 26, 0.1);
            transform: translateX(100%);
        }

        nav ul.visible {
            transform: translateX(0);
        }

        nav ul li a {
            text-decoration: none;
            color: #191919;
            font-weight: 600;
            padding: 1px 1rem;
            display: block;
            transition: color 300ms, background-color 300ms;
        }

        nav ul li a:hover {
            color: orangered;
            background-color: #f0f0f0;
        }

        .menu-icon {
            font-size: 28px;
            display: flex;
            align-items: center;
            cursor: pointer;
        }

        main {
            padding-top: 7rem;
            margin: 1rem;
        
        }

        @media only screen and (min-width: 2000px) {
            nav ul {
                display: flex;
                position: static;
                background-color: transparent;
                box-shadow: none;
                transform: none;
                transition: none;
            }

            nav ul.visible {
                display: flex;
                transform: none;
            }

            .menu-icon {
                display: none;
            }
        }  
        .title-header {
            font-size: 17px;
            font-weight: bold;
            margin: 0; /* No margin */
        }
        .centered-content {
            display: flex;
            flex-direction: column;
            align-items: center; /* Center horizontally */
            text-align: center; /* Center text within the container */
            margin-top: 20px; /* Space above the container */
        }
        .centered-content img {
            max-width: 50px; /* Control the size of the logo */
            margin-bottom: 10px; /* Space below the logo */
        }
        .centered-content h1 {
            font-size: 17px;
            font-weight: bold;
            margin: 5px 0; /* Space above and below each title */
        }
        .print-btn {
            cursor: pointer;
            color: #18de22;
            background: none;
            border: none;
            padding: 0;
        }
        .print-btn:hover {
            color: #0056b3;
        }
        .print-btn i {
            font-size: 16px; /* Adjust size as needed */
        }
        /* Cool infinite background scrolling animation.
 * Twitter: @kootoopas
 */
/* Exo thin font from Google. */
@import url('https://fonts.googleapis.com/css?family=Exo:100');
/* Background data (Original source: https://subtlepatterns.com/grid-me/) */
/* Animations */
@-webkit-keyframes bg-scrolling-reverse {
  100% {
    background-position: 50px 50px;
  }
}
@-moz-keyframes bg-scrolling-reverse {
  100% {
    background-position: 50px 50px;
  }
}
@-o-keyframes bg-scrolling-reverse {
  100% {
    background-position: 50px 50px;
  }
}
@keyframes bg-scrolling-reverse {
  100% {
    background-position: 50px 50px;
  }
}
@-webkit-keyframes bg-scrolling {
  0% {
    background-position: 50px 50px;
  }
}
@-moz-keyframes bg-scrolling {
  0% {
    background-position: 50px 50px;
  }
}
@-o-keyframes bg-scrolling {
  0% {
    background-position: 50px 50px;
  }
}
@keyframes bg-scrolling {
  0% {
    background-position: 50px 50px;
  }
}
/* Main styles */
body {
  margin-top: 6rem;
  /* img size is 50x50 */
  background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAIAAACRXR/mAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAABnSURBVHja7M5RDYAwDEXRDgmvEocnlrQS2SwUFST9uEfBGWs9c97nbGtDcquqiKhOImLs/UpuzVzWEi1atGjRokWLFi1atGjRokWLFi1atGjRokWLFi1af7Ukz8xWp8z8AAAA//8DAJ4LoEAAlL1nAAAAAElFTkSuQmCC") repeat 0 0;
  -webkit-animation: bg-scrolling-reverse 0.92s infinite;
  /* Safari 4+ */
  -moz-animation: bg-scrolling-reverse 0.92s infinite;
  /* Fx 5+ */
  -o-animation: bg-scrolling-reverse 0.92s infinite;
  /* Opera 12+ */
  animation: bg-scrolling-reverse 0.92s infinite;
  /* IE 10+ */
  -webkit-animation-timing-function: linear;
  -moz-animation-timing-function: linear;
  -o-animation-timing-function: linear;
  animation-timing-function: linear;
}
.dataTable {
  background-color: rgb(255, 255, 255); /* Atur warna background tabel */
  opacity: 1; /* Pastikan opacity tidak transparan */
  border-collapse: collapse; /* Opsional, untuk merapikan tampilan border */
  width: 100%; /* Sesuaikan dengan lebar yang diinginkan */
}

.dataTable th, .dataTable td {
  border: 1px solid black; /* Atur warna border */
  padding: 1px; /* Atur jarak antar teks dengan border */
  text-align: left; /* Atur perataan teks */
  color: black; /* Atur warna teks menjadi hitam */
  font-size: 12px; /* Atur ukuran teks, sesuaikan sesuai kebutuhan */
  font-family: Arial, sans-serif; /* Opsional, sesuaikan dengan font yang diinginkan */
}
    </style>
</head>
<body>
    <nav>
        <div class="logo-container">
            <img src="https://tse2.mm.bing.net/th?id=OIP.PEzGjWR5KT5_WBfoONYflwHaHZ&pid=Api&P=0&h=180" alt="my-avatar" />
            <span class="title">MTs. AL-UTSMANI</span>
        </div>
        <div id="menu-icon" class="menu-icon">
            <i class="ph-fill ph-list"></i>
        </div>
        <ul id="menu-list">
            <li><a href="index.html">Home</a></li>
            <li><a href="pembayaran.html">Pembayaran</a></li>
            <li><a href="kwitansi.html">Kwitansi</a></li>
            <li><a href="walikelas.html">Wali Kelas</a></li>
            <li><a href="https://wa.link/971ooz">Admin</a></li>
        </ul>
    </nav>
    <div class="container mt-4">
        <div class="row justify-content-center">
            <div class="col-md-12">
                <!-- Centered Logo and Title -->
                <div class="centered-content">
                    <img src="https://tse2.mm.bing.net/th?id=OIP.PEzGjWR5KT5_WBfoONYflwHaHZ&pid=Api&P=0&h=180" alt="Logo" class="img-fluid">
                    <h1 class="title-header">KWITANSI</h1>
            </div>
        </div>
        <div class="row mb-3">
            <div class="col-md-4">
                <div class="form-group">
                    <label for="classDropdown" class="form-label">Kelas</label>
                    <select id="classDropdown" class="form-select form-select-sm">
                        <option value="Semua">Pilih</option>
                <!-- Kelas 7 -->
                <option value="7A">7A</option>
                <option value="7B">7B</option>
                <option value="7C">7C</option>
                <option value="7D">7D</option>
                <option value="7E">7E</option>
                <option value="7F">7F</option>
                <option value="7G">7G</option>
                <option value="7H">7H</option>
                <!-- Kelas 8 -->
                <option value="8A">8A</option>
                <option value="8B">8B</option>
                <option value="8C">8C</option>
                <option value="8D">8D</option>
                <option value="8E">8E</option>
                <option value="8F">8F</option>
                <option value="8G">8G</option>
                <option value="8H">8H</option>
                <option value="8I">8I</option>
                <!-- Kelas 9 -->
                <option value="9A">9A</option>
                <option value="9B">9B</option>
                <option value="9C">9C</option>
                <option value="9D">9D</option>
                <option value="9E">9E</option>
                <option value="9F">9F</option>
                <option value="9G">9G</option>
                <option value="9H">9H</option>
                <option value="9I">9I</option>
                <option value="9J">9J</option>
            </select>
            <div class="d-flex align-items-center">
                <button id="exportButton" class="btn-custom">
                <i class="fas fa-file-excel"></i> Laporan
                </button>    
        </div>
            <table id="dataTable" class="table table-striped table-bordered" style="width:100%">
                <!-- Table headers will be dynamically populated by DataTables -->
            </table>
        </div>
<!-- jQuery -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<!-- Bootstrap JS and dependencies -->
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/5.3.0/js/bootstrap.min.js"></script>
<!-- DataTables JS -->
<script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.13.4/js/dataTables.bootstrap5.min.js"></script>
<!-- DataTables Responsive JS -->
<script src="https://cdn.datatables.net/responsive/2.4.0/js/dataTables.responsive.min.js"></script>
<script src="https://cdn.datatables.net/responsive/2.4.0/js/responsive.bootstrap5.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.9/xlsx.full.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

 <script>
            const menuIcon = document.getElementById("menu-icon");
        const menuList = document.getElementById("menu-list");

        menuIcon.addEventListener("click", () => {
            menuList.classList.toggle("visible");
        });
<!-- Table to display data -->
$(document).ready(function() {
    // Initialize DataTable
    var table = $('#dataTable').DataTable({
        ajax: {
            url: "https://script.google.com/macros/s/AKfycbwYuFGJmlpNuuwQ3fAZUpW0EPC0FH4KzW4FY7SKzfTYWrIPh6SxYuvl2UxK58i7YyaPCQ/exec?action=FetchData",
            dataSrc: '',
            error: function(xhr, error, thrown) {
                console.error("Error loading data:", error);
                alert("Error loading data. Please check the console for details.");
            }
        },
        columns: [
            { title: "ID:", data: "ID" },
            { title: "Nama:", data: "Nama" },
            { title: "Kelas:", data: "Kelas" },
            { title: "PPDB:", data: "PPDB" },
            { title: "LKS Ganjil 7:", data: "LKS_Ga_7" },
            { title: "LKS Genap 7:", data: "LKS_Ge_7" },
            { title: "Smst Ganjil 7:", data: "Smst_Ga_7" },
            { title: "Smst Genap 7:", data: "Smst_Ge_7" },
            { title: "LKS Ganjil 8:", data: "LKS_Ga_8" },
            { title: "LKS Genap 8:", data: "LKS_Ge_8" },
            { title: "Smst Ganjil 8:", data: "Smst_Ga_8" },
            { title: "Smst Genap 8:", data: "Smst_Ge_8" },
            { title: "LKS Ganjil 9:", data: "LKS_Ga_9" },
            { title: "LKS Genap 9:", data: "LKS_Ge_9" },
            { title: "Smst Ganjil 9:", data: "Smst_Ga_9" },
            { title: "AM:", data: "AM" },
            { title: "Wisuda:", data: "Wisuda" },
            { title: "Tambahan:", data: "Tambahan" },
            { title: "Rincian:", data: "Rincian" },
            { title: "Bayar:", data: "Bayar" },
            { title: "Total Tanggungan:", data: "Total" },
            { title: "Dibayar:", data: "Dibayar" },
            { title: "Sisa Tanggungan:", data: "Sisa" },
            { title: "Lunas/ Belum:", data: "Lunas" },
            { title: "Dapat PIP:", data: "Dapat_PIP" },
            { title: "Saldo PIP:", data: "Saldo_PIP" },
            { title: "Sisa PIP:", data: "Sisa_PIP" },
            { title: "Angkatan:", data: "Angkatan" },
            { title: "Status:", data: "Status" },
            { title: "Keterangan Mutasi:", data: "Ket_Mutasi" },
            { title: "Pernah Tidak Naik:", data: "Pernah_Tidak_Naik" },
            { title: "Pemotongan:", data: "Pemotongan" },
            { title: "Keterangan:", data: "Ket_Pem" },
            { title: "TPPDB", data: "TPPDB" },
            { title: "TLKS Ganjil 7", data: "TLKS_Ga_7" },
            { title: "TLKS Genap 7", data: "TLKS_Ge_7" },
            { title: "TSmst Ganjil 7", data: "TSmst_Ga_7" },
            { title: "TSmst Genap 7", data: "TSmst_Ge_7" },
            { title: "TLKS Ganjil 8", data: "TLKS_Ga_8" },
            { title: "TLKS Genap 8", data: "TLKS_Ge_8" },
            { title: "TSmst Ganjil 8", data: "TSmst_Ga_8" },
            { title: "TSmst Genap 8", data: "TSmst_Ge_8" },
            { title: "TLKS Ganjil 9", data: "TLKS_Ga_9" },
            { title: "TLKS Genap 9", data: "TLKS_Ge_9" },
            { title: "TSmst Ganjil 9", data: "TSmst_Ga_9" },
            { title: "TAM", data: "TAM" },
            { title: "TWisuda", data: "TWisuda" },
            { title: "KPPDB", data: "KPPDB" },
            { title: "KLKS Ganjil 7", data: "KLKS_Ga_7" },
            { title: "KLKS Genap 7", data: "KLKS_Ge_7" },
            { title: "KSmst Ganjil 7", data: "KSmst_Ga_7" },
            { title: "KSmst Genap 7", data: "KSmst_Ge_7" },
            { title: "KLKS Ganjil 8", data: "KLKS_Ga_8" },
            { title: "KLKS Genap 8", data: "KLKS_Ge_8" },
            { title: "KSmst Ganjil 8", data: "KSmst_Ga_8" },
            { title: "KSmst Genap 8", data: "KSmst_Ge_8" },
            { title: "KLKS Ganjil 9", data: "KLKS_Ga_9" },
            { title: "KLKS Genap 9", data: "KLKS_Ge_9" },
            { title: "KSmst Ganjil 9", data: "KSmst_Ga_9" },
            { title: "KAM", data: "KAM" },
            { title: "KWisuda", data: "KWisuda" },
            { title: "KTT", data: "KTT" },
            { title: "Print",
            
                data: null,
                defaultContent: '<button class="btn btn-primary print-btn"><i class="fas fa-print"></i></button>',
                orderable: false
            }
        ],
        language: {
    search: "Cari:" // Mengganti label Search dengan Cari
  },
        columnDefs: [
        {
      targets: 1, // Indeks kolom Nama (kolom pertama)
      createdCell: function (td, cellData, rowData, row, col) {
        $(td).css({
          "white-space": "nowrap", // Mencegah teks ter-wrap
          "overflow": "hidden",    // Opsional: Sembunyikan teks yang terlalu panjang
          "text-overflow": "ellipsis" // Opsional: Tampilkan "..." jika teks terlalu panjang
        });
      }
    },
            {
                targets: [1, 2, 20, 21, 22, 23, 62], // Adjusted to correct number of columns
                className: 'all'
            },
            {
                targets: [0, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61],
                visible: false, // Hide the first column (ID)
                searchable: true
            }
        ],
        paging: true,
        searching: true,
        ordering: true,
        responsive: true, // Enables responsive layout
        order: [[0, 'desc']],
        pageLength: 5,
        lengthMenu: [
            [5, 10, 25, 50, 100, -1],
            ['5', '10', '25', '50', '100', 'All']
        ],
    });

// Event listener for print button
$('#dataTable tbody').on('click', '.print-btn', function () {
    var data = table.row($(this).parents('tr')).data();
    printRowData(data);
});

// Event listener for class dropdown filter
$('#classDropdown').change(function() {
    var selectedClass = $(this).val(); // Get the selected value
    if (selectedClass === "Semua") {
        table.column(2).search('').draw(); // Clear filter if "Semua" is selected
    } else {
        table.column(2).search(selectedClass).draw(); // Apply filter based on the selected class
    }
});
});
document.getElementById('exportButton').addEventListener('click', function() {
    const originalTable = document.getElementById('dataTable');

    // Create a temporary table to handle hidden columns
    const tempTable = document.createElement('table');
    tempTable.innerHTML = originalTable.innerHTML;
    
    // Make all columns visible in the temporary table
    const headers = tempTable.querySelectorAll('thead th');
    headers.forEach(header => header.style.display = '');
    
    const rows = tempTable.querySelectorAll('tbody tr');
    rows.forEach(row => {
        const cells = row.querySelectorAll('td');
        cells.forEach(cell => cell.style.display = '');
    });

    // Create a new workbook and sheet
    const wb = XLSX.utils.book_new();
    
    // Extract headers and rows from the temporary table
    const cols = Array.from(tempTable.querySelectorAll('thead th')).map(th => th.textContent.trim());
    const dataRows = Array.from(tempTable.querySelectorAll('tbody tr')).map(tr =>
        Array.from(tr.querySelectorAll('td')).map(td => td.textContent.trim())
    );
    
    // Combine headers and data rows
    const fullData = [cols].concat(dataRows);
    
    // Convert the data to a sheet
    const fullSheet = XLSX.utils.aoa_to_sheet(fullData);
    
    // Add the sheet to the workbook
    XLSX.utils.book_append_sheet(wb, fullSheet, 'Sheet1');
    
    // Generate Excel file
    const wbout = XLSX.write(wb, { bookType: 'xlsx', type: 'binary' });

    // Convert string to array buffer
    function s2ab(s) {
        const buf = new ArrayBuffer(s.length);
        const view = new Uint8Array(buf);
        for (let i = 0; i < s.length; i++) {
            view[i] = s.charCodeAt(i) & 0xFF;
        }
        return buf;
    }

    // Save the file using FileSaver.js
    saveAs(new Blob([s2ab(wbout)], { type: "application/octet-stream" }), 'data.xlsx');
});



// Function to print row data
function printRowData(data) {
var printWindow = window.open('', '_blank');
printWindow.document.open();
printWindow.document.write(`
    <html>
                <head>
                    <meta charset="UTF-8">
                    <meta name="viewport" content="width=device-width, initial-scale=1.0">
                    <title>Kwitansi Pembayaran</title>
                    <link href="https://stackpath.bootstrapcdn.com/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
                    <style>
                /* Your existing styles */
.satu {font-size: 7px;
        }
        .dua {font-size: 12px;
        }
        .tiga {font-size: 15px;
        }
.modal-header {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 1px;
    border-bottom: 2px solid #4bfa06;
    background-color: transparent;
}

.modal-header img {
    height: 30px;
    margin-bottom: 2px;
    padding: 0px;
}

.modal-title {
    font-size: 12px; /* Set font size to 3px */
    font-weight: bold;
    text-align: center;
}

.modal-body {
    display: flex;
    flex-direction: row;
    padding: 1px;
    font-size: 9px; /* Set font size to 3px */
    gap: 2px;
    overflow-y: auto;
    max-height: calc(100% - 60px); /* Adjust based on header and footer heights */
    box-sizing: border-box;
}

.left, .right {
    flex: 1;
}

.section {
    margin-bottom: 2px;
}

.section-title {
    font-size: 10px; /* Set font size to 3px */
    font-weight: bold;
    margin-bottom: 1px;
    border-bottom: 1px solid #04ff21;
    padding-bottom: 1px;
}

.table th, .table td {
    vertical-align: middle;
    padding: 2px;
    text-align: left;
    word-wrap: break-word;
    font-size: 9px; /* Set font size to 3px */
}

.table thead th {
    background-color: #1c84d8;
    color: rgb(0, 0, 0);
}

.table tbody tr:nth-child(even) {
    background-color: #f8f8fa;
}

.table tbody tr:hover {
    background-color: #1e8af5;
}

.table td {
    text-align: right;
}

.table td:first-child {
    text-align: left;
}



.separator {
    border-top: 1px solid #d52828;
    margin: 5px 0;
}

@media print {
    .modal-dialog {
        width: 105mm;
        height: 148mm;
        margin: auto;
        padding: 0;
    }
    .modal-content {
        height: 100%;
        overflow: hidden;
        padding: 1px;
    }
    .modal-header {
        display: flex;
        padding: 1px;
        border-bottom: 1px solid #4bfa06;
        background-color: transparent;
    }
    .modal-header img {
        height: 30px;
        margin-bottom: 0px;
    }
    .modal-title {
        font-size: 9px; /* Set font size to 3px */
        font-weight: bold;
        text-align: center;
    }
    .modal-body {
        font-size: 9px; /* Set font size to 3px */
        padding: 1px;
        display: flex;
        flex-direction: row;
        gap: 2px;
        overflow: visible;
        max-height: 100%;
        box-sizing: border-box;
    }
    .left {
        width: 50%;
        padding-right: 1px; /* Adjust spacing between columns */
        box-sizing: border-box;
    }
    .right {
        width: 50%;
        padding-left: 1px; /* Adjust spacing between columns */
        box-sizing: border-box;
        text-align: right; /* Align text to the right for payment table */
    }
    .modal-footer {
        display: none;
    }
    .table th, .table td {
        padding: 1px;
        font-size: 9px; /* Set font size to 3px */
    }
    .table {
        width: 100%;
        border-collapse: collapse; /* Ensure borders collapse for a clean look */
    }
    /* General table styling */
.table {
    width: 100%;
    border-collapse: collapse; /* Ensure borders collapse for a clean look */
}

.table th, .table td {
    padding: 1px; /* Add padding for readability */
    border: 1px solid #ddd; /* Light border for separation */
    text-align: left; /* Align text to the left by default */
    vertical-align: middle; /* Align text vertically in the middle */
    word-wrap: break-word; /* Allow long words to break and wrap */
}

.table th {
    background-color: #1c84d8; /* Header background color */
    color: rgb(0, 0, 0); /* Header text color */
    font-size: 9px; /* Font size for header */
    font-weight: bold; /* Bold text for header */
}

.table tbody tr:nth-child(even) {
    background-color: #f8f8fa; /* Zebra striping for even rows */
}

.table tbody tr:hover {
    background-color: #1e8af5; /* Highlight row on hover */
}

.table td {
    font-size: 9px; /* Font size for data cells */
    text-align: right; /* Right-align text for data cells */
}

.table td:first-child {
    text-align: left; /* Left-align text for the first column */
}

<!-- CSS for Print -->

  @media print {
    body * {
      visibility: hidden; /* Hide everything outside the modal */
    }
    .modal-dialog {
      width: 105mm; /* Set width to A6 dimensions */
      max-width: none; /* Override Bootstrap max-width */
      height: 148mm; /* Set height to A6 dimensions */
    }
    .modal-content, .modal-content * {
      visibility: visible; /* Ensure modal content is visible */
    }
    .modal-content {
      position: absolute;
      left: 0;
      top: 0;
      right: 0;
      bottom: 0;
      margin: auto; /* Center modal content */
      box-shadow: none; /* Remove shadows for print */
      border: none; /* Remove borders for print */
    }
  }
}

                        /* Ensure all columns have equal width */
                        .table th, .table td {
                            width: 25%; /* 4 columns, so each column takes 25% */
                            text-align: left;
                        }
                    </style>
                </head>
                <body>
                    <!-- Modal Structure -->
<div class="modal fade" id="myModal" tabindex="-1" aria-labelledby="modalLabel" aria-hidden="true">
  <div class="modal-dialog modal-sm"> <!-- Set modal size to small -->
    <div class="modal-content">
      <div class="modal-header d-flex align-items-center justify-content-center p-2"> <!-- Center all content with no gaps -->
        <img src="https://tse2.mm.bing.net/th?id=OIP.PEzGjWR5KT5_WBfoONYflwHaHZ&pid=Api&P=0&h=180" alt="Logo" style="width: 30px; height: 30px; margin: 0; padding: 0;"> <!-- Remove margin and padding -->
        <div class="text-center"> <!-- Container for text alignment -->
          <h5 class="modal-title mb-0" id="modalLabel" style="font-size: 12px; margin: 0; padding: 0;">MTs. AL-UTSMANI</h5>
          <h5 class="modal-title mb-0" id="modalLabel" style="font-size: 10px; margin: 0; padding: 0;">KWITANSI PEMBAYARAN</h5>
        </div>
                            <div class="modal-body">
                                <div class="left">
                                    <div class="section">
                                        <div class="section-title">BIODATA :</div>
                                        <table class="table">
                                            <tbody>
                                                <tr><th>NIS</th><td>${data.ID}</td></tr>
                                                <tr><th>Nama</th><td>${data.Nama}</td></tr>
                                                <tr><th>Kelas</th><td>${data.Kelas}</td></tr>
                                                <tr><th>Angkatan</th><td>${data.Angkatan}</td></tr>
                                                <tr><th>Status</th><td>${data.Status}</td></tr>
                                                <tr><th>Keterangan Mutasi</th><td>${data.Ket_Mutasi}</td></tr>
                                                <tr><th>Pernah Tidak Naik Kelas</th><td>${data.Pernah_Tidak_Naik}</td></tr>
                                                <tr><th>Dapat PIP</th><td>${data.Dapat_PIP}</td></tr>
                                                <tr><th>Saldo</th><td>${data.Saldo_PIP}</td></tr>
                                                <tr><th>Sisa</th><td>${data.Sisa_PIP}</td></tr>
                                            </tbody>
                                        </table>
                                    </div>
                                    <div class="section">
                                        <div class="section-title">TANGGUNGAN :</div>
                                        <table class="table">
                                            <tbody>
                                                <tr><th>Total Tanggungan</th><td>${data.Total}</td></tr>
                                                <tr><th>Pemotongan</th><td>${data.Pemotongan}</td></tr>
                                                <tr><th>Total Bayar</th><td>${data.Dibayar}</td></tr>
                                                <tr><th>Sisa</th><td>${data.Sisa}</td></tr>
                                                <tr><th>Lunas/Belum</th><td>${data.Lunas}</td></tr>
                                            </tbody>
                                        </table>
                                    </div>
                                    <div class="section">
                                        <div class="section-title">KETERANGAN :</div>
                                        <table class="table">
                                            <tbody>
                                                <tr><th>Tanggungan Tambahan</th><td>${data.Rincian}</td></tr>
                                                <tr><th>Pemotongan</th><td>${data.Ket_Pem}</td></tr>
                                            </tbody>
                                        </table>
                                            </div>
                                        <div class="section">
                                            <div class="section-title"></div>  
                                               
                                            <p class="dua">Petugas</p>
                                    </div>
                                </div>
                                <div class="right">
                                    <div class="section">
                                        <div class="section-title">UNTUK PEMBAYARAN :</div>
                                        <div class="right-group w-50">
                                            <table class="table group-table">
                                                <thead>
                                                    <tr>
                                                        <th>RINCIAN</th>
                                                        <th>JUMLAH</th>
                                                        <th>BAYAR</th>
                                                        <th>KURANG</th>
                                                    </tr>
                                                </thead>
                                                <tbody id="paymentTable">
                                                <!-- 15 rows -->
                                                <tr><td>PPDB</td><td>${data.TPPDB}</td><td>${data.PPDB}</td><td>${data.KPPDB}</td></tr>
                                                <tr><td>LKS Ganjil 7</td><td>${data.TLKS_Ga_7}</td><td>${data.LKS_Ga_7}</td><td>${data.KLKS_Ga_7}</td></tr>
                                                <tr><td>Ujian Ganjil 7</td><td>${data.TSmst_Ga_7}</td><td>${data.Smst_Ga_7}</td><td>${data.KSmst_Ga_7}</td></tr>
                                                <tr><td>LKS Genap 7</td><td>${data.TLKS_Ge_7}</td><td>${data.LKS_Ge_7}</td><td>${data.KLKS_Ge_7}</td></tr>
                                                <tr><td>Ujian Genap 7</td><td>${data.TSmst_Ge_7}</td><td>${data.Smst_Ge_7}</td><td>${data.KSmst_Ge_7}</td></tr>
                                                <tr><td>LKS Ganjil 8</td><td>${data.TLKS_Ga_8}</td><td>${data.LKS_Ga_8}</td><td>${data.KLKS_Ga_8}</td></tr>
                                                <tr><td>Ujian Ganjil 8</td><td>${data.TSmst_Ga_8}</td><td>${data.Smst_Ga_8}</td><td>${data.KSmst_Ga_8}</td></tr>
                                                <tr><td>LKS Genap 8</td><td>${data.TLKS_Ge_8}</td><td>${data.LKS_Ge_8}</td><td>${data.KLKS_Ge_8}</td></tr>
                                                <tr><td>Ujian Genap 8</td><td>${data.TSmst_Ge_8}</td><td>${data.Smst_Ge_8}</td><td>${data.KSmst_Ge_8}</td></tr>
                                                <tr><td>LKS Ganjil 9</td><td>${data.TLKS_Ga_9}</td><td>${data.LKS_Ga_9}</td><td>${data.KLKS_Ga_9}</td></tr>
                                                <tr><td>Ujian Ganjil 9</td><td>${data.TSmst_Ga_9}</td><td>${data.Smst_Ga_9}</td><td>${data.KSmst_Ga_9}</td></tr>
                                                <tr><td>LKS Genap 9</td><td>${data.TLKS_Ge_9}</td><td>${data.LKS_Ge_9}</td><td>${data.KLKS_Ge_9}</td></tr>
                                                <tr><td>AM</td><td>${data.TAM}</td><td>${data.AM}</td><td>${data.KAM}</td></tr>
                                                <tr><td>Wisuda</td><td>${data.TWisuda}</td><td>${data.Wisuda}</td><td>${data.KWisuda}</td></tr>
                                                <tr><td>Tanggungan Tambahan</td><td>${data.Tambahan}</td><td>${data.Bayar}</td><td>${data.KTT}</td></tr>
                                                </tbody>
                                                </table>
                                            </div>
                                        <div class="section">
                                            <div class="section-title"></div>
                                            <p class="satu">Nb. Jika Anda ingin mengetahui pembayaran putra-putri Anda, Silahkan akses link "s.id/MTsAU" melalui Google di HP Anda masing-masing</p>     
                                            
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-primary" onclick="print()">Print</button>
                            </div>
                        </div>
                    </div>
                </div>   
        `);
        printWindow.document.close();
        printWindow.focus();
        printWindow.print();
    }
    </script>
</body>
</html>
