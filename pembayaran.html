<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="style.css" />
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <link href="https://cdn.datatables.net/v/bs5/jszip-2.5.0/b-2.3.5/b-html5-2.3.5/datatables.min.css" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.2.0/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.datatables.net/1.13.3/css/dataTables.bootstrap5.min.css" rel="stylesheet">
<link href="https://cdn.datatables.net/responsive/2.4.0/css/responsive.bootstrap5.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap">
<link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.3.6/css/buttons.bootstrap5.min.css">

    <!-- Tag link untuk favicon -->
    <link rel="icon" href="https://tse2.mm.bing.net/th?id=OIP.PEzGjWR5KT5_WBfoONYflwHaHZ&pid=Api&P=0&h=180" type="image/x-icon" />
    <!-- Tag meta untuk gambar ketika dibagikan di media sosial -->
    <meta property="og:image" content="https://tse2.mm.bing.net/th?id=OIP.PEzGjWR5KT5_WBfoONYflwHaHZ&pid=Api&P=0&h=180" />
    <style>

html {
  padding: 0;
  margin: 0;
  box-sizing: border-box;
}

nav {
  background-color: rgb(255, 255, 255);
  display: flex;
  justify-content: space-between;
  padding: 1rem 1rem;
  position: fixed;
  width: 100%;
  top: 0;
  z-index: 1000;
  align-items: center;
}

nav .logo-container {
  display: flex;
  align-items: center;
}

nav .logo-container img {
  width: 40px;
  margin-right: 0.5rem;
}

nav .logo-container .title {
  font-size: 1rem;
  font-weight: bold;
  color: #191919;
}

nav ul {
  display: flex;
  align-items: center;
  gap: 0rem;
  list-style: none;
  padding: 0;
  margin: 0;
  transition: transform 300ms ease;
  position: absolute;
  top: 100%;
  right: 0;
  background-color: rgb(255, 255, 255);
  border: 1px solid #dae40f;
  box-shadow: 0px 4px 6px rgba(252, 248, 26, 0.1);
  transform: translateX(100%);
}

nav ul.visible {
  transform: translateX(0);
}

nav ul li a {
  text-decoration: none;
  color: #191919;
  font-weight: 600;
  padding: 1px 1rem;
  display: block;
  transition: color 300ms, background-color 300ms;
}

nav ul li a:hover {
  color: orangered;
  background-color: #f0f0f0;
}

.menu-icon {
  font-size: 28px;
  display: flex;
  align-items: center;
  cursor: pointer;
}

main {
  padding-top: 7rem;
  margin: 1rem;
}

@media only screen and (min-width: 500px) {
  nav ul {
    display: flex;
    position: static;
    background-color: transparent;
    box-shadow: none;
    transform: none;
    transition: none;
  }

  nav ul.visible {
    display: flex;
    transform: none;
  }

  .menu-icon {
    display: none;
  }
}

.title-header {
  font-size: 10px;
  font-weight: bold;
  margin: 0; /* No margin */
}

.btn-custom {
  background-color: #007bff; /* Custom background color */
  color: #fff; /* Text color */
  border: none; /* Remove border */
  border-radius: 4px; /* Rounded corners */
  padding: 5px 10px; /* Padding */
  font-size: 13px; /* Font size */
  transition: background-color 0.3s; /* Smooth transition */
  display: flex;
  align-items: center;
}

.btn-custom:hover {
  background-color: #0056b3; /* Darker color on hover */
}

.btn-custom i {
  margin-right: 1px; /* Space between icon and text */
}

.form-group {
  margin: 0; /* No margin */
}

.form-select-custom {
  background-color: #007efc; /* Light grey background */
  color: #ffffff; /* Darker text color */
  border: 1px solid #007efc; /* Light border */
  border-radius: 4px; /* Rounded corners */
  padding: 3px; /* Padding */
  width: 90px; /* Fixed width */
}

.form-select-custom option {
  color: #fefefe; /* Text color for options */
}

.d-flex-custom {
  display: flex;
  align-items: center;
  margin-bottom: 1px; /* Space below the container */
}

.d-flex-custom > * {
  margin-right: 1px; /* Space between elements */
}

</style>
</head>
<body>
    <nav>
        <div class="logo-container">
            <img src="https://tse2.mm.bing.net/th?id=OIP.PEzGjWR5KT5_WBfoONYflwHaHZ&pid=Api&P=0&h=180" alt="my-avatar" />
            <span class="title">MTs. AL-UTSMANI</span>
        </div>
        <div id="menu-icon" class="menu-icon">
            <i class="ph-fill ph-list"></i>
        </div>
        <ul id="menu-list">
            <li><a href="index.html">Home</a></li>
            <li><a href="pembayaran.html">Pembayaran</a></li>
            <li><a href="kwitansi.html">Kwitansi</a></li>
            <li><a href="walikelas.html">Wali Kelas</a></li>
            <li><a href="admin.html">Admin</a></li>
        </ul>
    </nav>
    <div class="container mt-4">
        <div class="row justify-content-start align-items-center">
            <div class="col-md-12">
                <!-- Logo and Title -->
                <div class="d-flex flex-column align-items-center">
                    <img src="https://tse2.mm.bing.net/th?id=OIP.PEzGjWR5KT5_WBfoONYflwHaHZ&pid=Api&P=0&h=180" alt="Logo" class="img-fluid" style="max-width: 50px;">
                    <h1 class="title-header">PEMBAYARAN</h1>
            </div>
            <!-- Button and Dropdown -->
            
                <div class="form-group ml-2">
                    <label for="classDropdown" class="form-label sr-only">Kelas</label>
                    <select id="classDropdown" name="classDropdown" class="form-select form-select-sm form-select-custom">
                        <option value="Semua">Kelas</option>
                        <!-- Kelas 7 -->
                        <option value="7A">7A</option>
                        <option value="7B">7B</option>
                        <option value="7C">7C</option>
                        <option value="7D">7D</option>
                        <option value="7E">7E</option>
                        <option value="7F">7F</option>
                        <option value="7G">7G</option>
                        <option value="7H">7H</option>
                        <!-- Kelas 8 -->
                        <option value="8A">8A</option>
                        <option value="8B">8B</option>
                        <option value="8C">8C</option>
                        <option value="8D">8D</option>
                        <option value="8E">8E</option>
                        <option value="8F">8F</option>
                        <option value="8G">8G</option>
                        <option value="8H">8H</option>
                        <option value="8I">8I</option>
                        <!-- Kelas 9 -->
                        <option value="9A">9A</option>
                        <option value="9B">9B</option>
                        <option value="9C">9C</option>
                        <option value="9D">9D</option>
                        <option value="9E">9E</option>
                        <option value="9F">9F</option>
                        <option value="9G">9G</option>
                        <option value="9H">9H</option>
                        <option value="9I">9I</option>
                        <option value="9J">9J</option>
                    </select>
                </div>
                <div class="d-flex align-items-center">
                    <button id="exportButton" class="btn-custom">
                    <i class="fas fa-file-excel"></i> Laporan
                    </button>    
            </div>
        </div>
    </div>    
    <div class="row">
        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12" style="overflow-x: auto;">
            <br>
            <table id="dataTable" class="table table-striped table-bordered nowrap" style="width:100%"></table>
            <br />
            <br />
            <p id="passingGrade"></p>
        </div>
    </div>
<!-- Modal Form -->
<div class="modal fade" id="myModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-scrollable">
        <div class="modal-content">
<!-- Modal Header -->
<div class="modal-header">
    <h5 class="modal-title" id="myModalLabel">Form Input-Edit</h5>
</div>
<!-- Modal Body -->
<div class="modal-body">
    <form id="myForm">
        <div class="container">
            <!-- Row 1 -->
            <div class="row mb-3">
                <div class="col-md-3">
                    <label for="ID" class="form-label">ID:</label>
                    <input id="ID" name="ID" class="form-control form-control-sm" readonly>
                </div>
                <div class="col-md-3">
                    <label for="Nama" class="form-label">Nama:</label>
                    <input type="text" id="Nama" name="Nama" class="form-control form-control-sm">
                </div>
                <div class="col-md-3">
                    <label for="Kelas" class="form-label">Kelas:</label>
                    <select id="Kelas" name="Kelas" class="form-select form-select-sm">
                        <option value="" disabled selected>Pilih</option>
                        <!-- Grade Level Options -->
                        <option value="7A">7A</option>
                        <option value="7B">7B</option>
                        <option value="7C">7C</option>
                        <option value="7D">7D</option>
                        <option value="7E">7E</option>
                        <option value="7F">7F</option>
                        <option value="7G">7G</option>
                        <option value="7H">7H</option>
                        <option value="7I">7I</option>
                        <option value="7J">7J</option>
                        <option value="8A">8A</option>
                        <option value="8B">8B</option>
                        <option value="8C">8C</option>
                        <option value="8D">8D</option>
                        <option value="8E">8E</option>
                        <option value="8F">8F</option>
                        <option value="8G">8G</option>
                        <option value="8H">8H</option>
                        <option value="8I">8I</option>
                        <option value="8J">8J</option>
                        <option value="9A">9A</option>
                        <option value="9B">9B</option>
                        <option value="9C">9C</option>
                        <option value="9D">9D</option>
                        <option value="9E">9E</option>
                        <option value="9F">9F</option>
                        <option value="9G">9G</option>
                        <option value="9H">9H</option>
                        <option value="9I">9I</option>
                        <option value="9J">9J</option>
                    </select>
                </div>
                <div class="col-md-3">
                    <label for="PPDB" class="form-label">PPDB:</label>
                    <input type="text" id="PPDB" name="PPDB" class="form-control form-control-sm">
                </div>
            </div>

            <!-- Row 2 -->
            <div class="row mb-3">
                <div class="col-md-3">
                    <label for="LKS_Ga_7" class="form-label">LKS_Ga_7:</label>
                    <input type="text" id="LKS_Ga_7" name="LKS_Ga_7" class="form-control form-control-sm">
                </div>
                <div class="col-md-3">
                    <label for="LKS_Ge_7" class="form-label">LKS_Ge_7:</label>
                    <input type="text" id="LKS_Ge_7" name="LKS_Ge_7" class="form-control form-control-sm">
                </div>
                <div class="col-md-3">
                    <label for="Smst_Ga_7" class="form-label">Smst_Ga_7:</label>
                    <input type="text" id="Smst_Ga_7" name="Smst_Ga_7" class="form-control form-control-sm">
                </div>
                <div class="col-md-3">
                    <label for="Smst_Ge_7" class="form-label">Smst_Ge_7:</label>
                    <input type="text" id="Smst_Ge_7" name="Smst_Ge_7" class="form-control form-control-sm">
                </div>
            </div>

            <!-- Row 3 -->
            <div class="row mb-3">
                <div class="col-md-3">
                    <label for="LKS_Ga_8" class="form-label">LKS_Ga_8:</label>
                    <input type="text" id="LKS_Ga_8" name="LKS_Ga_8" class="form-control form-control-sm">
                </div>
                <div class="col-md-3">
                    <label for="LKS_Ge_8" class="form-label">LKS_Ge_8:</label>
                    <input type="text" id="LKS_Ge_8" name="LKS_Ge_8" class="form-control form-control-sm">
                </div>
                <div class="col-md-3">
                    <label for="Smst_Ga_8" class="form-label">Smst_Ga_8:</label>
                    <input type="text" id="Smst_Ga_8" name="Smst_Ga_8" class="form-control form-control-sm">
                </div>
                <div class="col-md-3">
                    <label for="Smst_Ge_8" class="form-label">Smst_Ge_8:</label>
                    <input type="text" id="Smst_Ge_8" name="Smst_Ge_8" class="form-control form-control-sm">
                </div>
            </div>

            <!-- Row 4 -->
            <div class="row mb-3">
                <div class="col-md-3">
                    <label for="LKS_Ga_9" class="form-label">LKS_Ga_9:</label>
                    <input type="text" id="LKS_Ga_9" name="LKS_Ga_9" class="form-control form-control-sm">
                </div>
                <div class="col-md-3">
                    <label for="LKS_Ge_9" class="form-label">LKS_Ge_9:</label>
                    <input type="text" id="LKS_Ge_9" name="LKS_Ge_9" class="form-control form-control-sm">
                </div>
                <div class="col-md-3">
                    <label for="Smst_Ga_9" class="form-label">Smst_Ga_9:</label>
                    <input type="text" id="Smst_Ga_9" name="Smst_Ga_9" class="form-control form-control-sm">
                </div>
                <div class="col-md-3">
                    <label for="AM" class="form-label">AM:</label>
                    <input type="text" id="AM" name="AM" class="form-control form-control-sm">
                </div>
            </div>

            <!-- Additional Fields in Row 4 -->
            <div class="row mb-3">
                <div class="col-md-3">
                    <label for="Wisuda" class="form-label">Wisuda:</label>
                    <input type="text" id="Wisuda" name="Wisuda" class="form-control form-control-sm">
                </div>
                <div class="col-md-3">
                    <label for="Tambahan" class="form-label">Tambahan:</label>
                    <input type="text" id="Tambahan" name="Tambahan" class="form-control form-control-sm">
                </div>
                <div class="col-md-3">
                    <label for="Rincian" class="form-label">Rincian:</label>
                    <input type="text" id="Rincian" name="Rincian" class="form-control form-control-sm">
                </div>
                <div class="col-md-3">
                    <label for="Bayar" class="form-label">Bayar:</label>
                    <input type="text" id="Bayar" name="Bayar" class="form-control form-control-sm">
                </div>
            </div>
            <!-- Row 7 -->
            <div class="row mb-3">
                <div class="col-md-3">
                    <label for="Dapat_PIP" class="form-label">Dapat PIP:</label>
                    <input type="text" id="Dapat_PIP" name="Dapat_PIP" class="form-control form-control-sm">
                </div>
                <div class="col-md-3">
                    <label for="Saldo_PIP" class="form-label">Saldo PIP:</label>
                    <input type="text" id="Saldo_PIP" name="Saldo_PIP" class="form-control form-control-sm">
                </div>
                <div class="col-md-3">
                    <label for="Sisa_PIP" class="form-label">Sisa PIP:</label>
                    <input type="text" id="Sisa_PIP" name="Sisa_PIP" class="form-control form-control-sm">
                </div>
                <div class="col-md-3">
                    <label for="Angkatan" class="form-label">Angkatan:</label>
                    <select id="Angkatan" name="Angkatan" class="form-select form-select-sm">
                        <option value="" disabled selected>Pilih</option>
                        <option value="2022">2022</option>
                        <option value="2023">2023</option>
                        <option value="2024">2024</option>
                        <option value="2025">2025</option>
                        <option value="2026">2026</option>
                    </select>
                </div>
            </div>

            <!-- Row 8 -->
            <div class="row mb-3">
                <div class="col-md-3">
                    <label for="Status" class="form-label">Status:</label>
                    <select id="Status" name="Status" class="form-select form-select-sm">
                        <option value="" disabled selected>Pilih</option>
                        <option value="Baru">Baru</option>
                        <option value="Mutasi7">Mutasi7</option>
                        <option value="Mutasi8">Mutasi8</option>
                        <option value="Mutasi9">Mutasi9</option>
                    </select>
                </div>
                <div class="col-md-3">
                    <label for="Ket_Mutasi" class="form-label">Ket Mutasi:</label>
                    <select id="Ket_Mutasi" name="Ket_Mutasi" class="form-select form-select-sm">
                        <option value="" disabled selected>Pilih</option>
                        <option value="Genap">Genap</option>
                    </select>
                </div>
                <div class="col-md-3">
                    <label for="Pernah_Tidak_Naik" class="form-label">Pernah Tidak Naik:</label>
                    <select id="Pernah_Tidak_Naik" name="Pernah_Tidak_Naik" class="form-select form-select-sm">
                        <option value="" disabled selected>Pilih</option>
                        <option value="7">7</option>
                        <option value="8">8</option>
                        <option value="9">9</option>
                    </select>
                </div>
                <div class="col-md-3">
                    <label for="Pemotongan" class="form-label">Pemotongan:</label>
                    <input type="text" id="Pemotongan" name="Pemotongan" class="form-control form-control-sm">
                </div>
            </div>

            <!-- Row 9 -->
            <div class="row mb-3">
                <div class="col-md-3">
                    <label for="Ket_Pem" class="form-label">Ket Pem:</label>
                    <input type="text" id="Ket_Pem" name="Ket_Pem" class="form-control form-control-sm">
                </div>
            </div>
        </div>
    </form>
</div>

<!-- Modal Footer -->
<div class="modal-footer">
<button type="button" id="submitBtn" class="btn btn-primary" onclick="updateForm()">Save</button>
<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>
<!-- Scripts -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
<script>
            const menuIcon = document.getElementById("menu-icon");
        const menuList = document.getElementById("menu-list");

        menuIcon.addEventListener("click", () => {
            menuList.classList.toggle("visible");
        });
async function updateForm() {
    try {
        // Get the form element
        const form = document.getElementById('myForm');
        if (!form) throw new Error('Form element not found');

        // Create FormData object from the form
        const formData = new FormData(form);

        // Log FormData key-value pairs
        formData.forEach((value, key) => {
            console.log(`${key}: ${value}`);
        });

        // Append additional parameters if needed
        formData.append('action', 'Update');
        formData.append('sh', 'Data');

        // Disable the submit button to prevent multiple submissions
        const submitButton = document.getElementById('submitBtn');
        if (!submitButton) throw new Error('Submit button not found');
        submitButton.disabled = true;

        // Show loading indicator
        const loadingIndicator = document.getElementById('loadingIndicator');
        if (loadingIndicator) loadingIndicator.style.display = 'block';

        // Send the POST request
        const response = await fetch('https://script.google.com/macros/s/AKfycbwk6rBZ-rXkqtJTJe3bk6XNtPHTBqw5BPccTAJb7-0CWFz8ntRc0WPhUNfDDk6xetdfbA/exec', {
    method: 'POST',
    body: formData
    });


        if (!response.ok) {
            throw new Error(`HTTP error! Status: ${response.status}`);
        }

        const result = await response.text();
        console.log("Server Response:", result);

        alert("Data updated successfully!");
        $('#myModal').modal('hide');

        // Refresh the DataTable
        const table = $('#dataTable').DataTable();
        table.ajax.reload();

    } catch (error) {
        console.error('Update Error:', error);
        alert("Error updating data. Please check the console for details.");
    } finally {
        // Re-enable the submit button
        const submitButton = document.getElementById('submitBtn');
        if (submitButton) {
            submitButton.disabled = false;
        }

        // Hide the loading indicator
        const loadingIndicator = document.getElementById('loadingIndicator');
        if (loadingIndicator) {
            loadingIndicator.style.display = 'none';
        }
    }
}




    function printReceipt() {
        // Add your receipt printing logic here
        console.log("Kwitansi button clicked");
    }
</script>

<style>
    .title-header {
        font-family: 'Roboto', sans-serif; /* Example of a modern font */
        font-size: 18px;
        font-weight: bold;
        text-align: center;
        margin-bottom: 20px;
        color: #333; /* Adjust color as needed */
    }
/* Cool infinite background scrolling animation.
 * Twitter: @kootoopas
 */
/* Exo thin font from Google. */
@import url(https://fonts.googleapis.com/css?family=Exo:100);
/* Background data (Original source: https://subtlepatterns.com/grid-me/) */
/* Animations */
@-webkit-keyframes bg-scrolling-reverse {
  100% {
    background-position: 50px 50px;
  }
}
@-moz-keyframes bg-scrolling-reverse {
  100% {
    background-position: 50px 50px;
  }
}
@-o-keyframes bg-scrolling-reverse {
  100% {
    background-position: 50px 50px;
  }
}
@keyframes bg-scrolling-reverse {
  100% {
    background-position: 50px 50px;
  }
}
@-webkit-keyframes bg-scrolling {
  0% {
    background-position: 50px 50px;
  }
}
@-moz-keyframes bg-scrolling {
  0% {
    background-position: 50px 50px;
  }
}
@-o-keyframes bg-scrolling {
  0% {
    background-position: 50px 50px;
  }
}
@keyframes bg-scrolling {
  0% {
    background-position: 50px 50px;
  }
}
/* Main styles */
body {
  margin-top: 6rem;
  color: #999;
  font: 400 16px/1.5 exo, ubuntu, "segoe ui", helvetica, arial, sans-serif;
  text-align: left;
  /* img size is 50x50 */
  background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAIAAACRXR/mAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAABnSURBVHja7M5RDYAwDEXRDgmvEocnlrQS2SwUFST9uEfBGWs9c97nbGtDcquqiKhOImLs/UpuzVzWEi1atGjRokWLFi1atGjRokWLFi1atGjRokWLFi1af7Ukz8xWp8z8AAAA//8DAJ4LoEAAlL1nAAAAAElFTkSuQmCC") repeat 0 0;
  -webkit-animation: bg-scrolling-reverse 0.92s infinite;
  /* Safari 4+ */
  -moz-animation: bg-scrolling-reverse 0.92s infinite;
  /* Fx 5+ */
  -o-animation: bg-scrolling-reverse 0.92s infinite;
  /* Opera 12+ */
  animation: bg-scrolling-reverse 0.92s infinite;
  /* IE 10+ */
  -webkit-animation-timing-function: linear;
  -moz-animation-timing-function: linear;
  -o-animation-timing-function: linear;
  animation-timing-function: linear;
}
.dataTable {
  background-color: rgb(255, 255, 255); /* Atur warna background tabel */
  opacity: 1; /* Pastikan opacity tidak transparan */
  border-collapse: collapse; /* Opsional, untuk merapikan tampilan border */
  width: 100%; /* Sesuaikan dengan lebar yang diinginkan */
}

.dataTable th, .dataTable td {
  text-align: left; /* Atur perataan teks */
  color: black; /* Atur warna teks menjadi hitam */
  font-size: 17px; /* Atur ukuran teks, sesuaikan sesuai kebutuhan */
  font-family: Impact, Haettenschweiler, 'Arial Narrow Bold', sans-serif, sans-serif; /* Opsional, sesuaikan dengan font yang diinginkan */
}
p, h1, h2, h3, h4, h5, h6, div, span, td, th {
  opacity: 1; /* Pastikan teks dalam elemen-elemen ini tidak transparan */
  color: black; /* Atur warna teks menjadi hitam */
}
        .cool-box {
            background: linear-gradient(320deg, #000000, #0502b4);
            border: 2px solid #ffffff;
            border-radius: 10px; /* Sudut sudut kotak */
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5); /* Bayangan */
            padding: 20px; /* Ukuran padding yang benar */
            width: 80%; /* Lebar kotak */
            max-width: 300px;
            margin: auto; /* Pusatkan kotak secara horizontal */
            flex-direction: column;
            align-items: center;
            position:static;
            overflow: hidden;
            transition: max-height 1s ease-out, top 0.8s ease-in-out;
        }


        .cool-box input {
            font-weight: bold;
            font-size:medium;
        }


        .Heading3 {
            text-align: center;
            margin-bottom: 20px;
            font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;
            color:#0502b4;
        }

        .Biodata{
            background-color: #ffffff;
            align-items: center;
            margin: auto;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            margin-top: 15px;
            max-width: 400px;
            
            transition: opacity 0.5s;
        }

        

        .visible {
            display: block;
            opacity: 1;
        }

        .hidden {
            display: none !important;
            opacity: 0;
        }


        .TTL{
            background-color: #dadada00;
            display:inline-flex;
            justify-content:space-between; /* Untuk memberikan jarak antara elemen-elemen di dalam .ttl */
        }

        .TTL label{
            width: 100px;
        }

        



        /* HTML: <div class="loader"></div> */
        #loader {
            width: 100%;
            height: 20px;
            background: 
                linear-gradient(#07971a 0 0) left -40px top 0/40px 20px,
                linear-gradient(#ddd 0 0) center/100% 50%; 
            background-repeat: no-repeat;
            animation: l5 1s infinite linear;
            }
            @keyframes l5 {
            100% {background-position: right -40px top 0,center}
        }

        /* Gaya mode terang untuk semua dropdown */
        select::-webkit-calendar-picker-indicator {
            color: #0a0a0a; /* Warna teks pada mode gelap */
            background-color: #f7f7f7; /* Warna latar belakang pada mode gelap */
        }

        /* Gaya mode gelap untuk semua dropdown */
        @media (prefers-color-scheme: dark) {
            select::-webkit-calendar-picker-indicator {
                color: #fff; /* Warna teks pada mode gelap */
                background-color: #242424; /* Warna latar belakang pada mode gelap */
            }
        }

        #Judul{
            font-weight: bold;
        }

        #example {
            background-color: white; /* Memberikan latar belakang putih pada tabel */
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); /* Menambahkan bayangan pada tabel */
            
        }

    
    </style>
    
 	<!-- DataTable  -->
     <div class="container-fluid">
		<?!= include('DataTable'); ?> <!-- See DataTable.html File -->
	</div>
    <script src = "https://code.jquery.com/jquery-3.5.1.js" ></script>
    <script src = "https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.2.0/js/bootstrap.bundle.min.js" > </script> 
    <script src = "https://cdn.datatables.net/1.13.3/js/jquery.dataTables.min.js" > </script> 
    <script src = "https://cdn.datatables.net/1.13.3/js/dataTables.bootstrap5.min.js" > </script> 
    <script src = "https://cdn.datatables.net/responsive/2.4.0/js/dataTables.responsive.min.js" > </script> 
    <script src = "https://cdn.datatables.net/responsive/2.4.0/js/responsive.bootstrap5.min.js" > </script>
    <script src = "https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" > </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/file-saver/dist/FileSaver.min.js"></script>
    <script>
function onReload() {
    var baseUrl = "https://script.google.com/macros/s/AKfycbwk6rBZ-rXkqtJTJe3bk6XNtPHTBqw5BPccTAJb7-0CWFz8ntRc0WPhUNfDDk6xetdfbA/exec?action=FetchData";

    $("#dataTable").DataTable({
        ajax: {
            url: baseUrl,
            dataSrc: '',
            error: function(xhr, error, thrown) {
                console.error("Error loading data:", error);
                alert("Error loading data. Please check the console for details.");
            }
        },
        columns: [
            { title: "ID :", data: "ID" },
            { title: "Nama :", data: "Nama" },
            { title: "Kelas :", data: "Kelas" },
            { title: "PPDB :", data: "PPDB" },
            { title: "LKS Ganjil 7 :", data: "LKS_Ga_7" },
            { title: "LKS Genap 7 :", data: "LKS_Ge_7" },
            { title: "Smst Ganjil 7 :", data: "Smst_Ga_7" },
            { title: "Smst Genap 7 :", data: "Smst_Ge_7" },
            { title: "LKS Ganjil 8 :", data: "LKS_Ga_8" },
            { title: "LKS Genap 8 :", data: "LKS_Ge_8" },
            { title: "Smst Ganjil 8 :", data: "Smst_Ga_8" },
            { title: "Smst Genap 8 :", data: "Smst_Ge_8" },
            { title: "LKS Ganjil 9 :", data: "LKS_Ga_9" },
            { title: "LKS Genap 9 :", data: "LKS_Ge_9" },
            { title: "Smst Ganjil 9 :", data: "Smst_Ga_9" },
            { title: "AM :", data: "AM" },
            { title: "Wisuda :", data: "Wisuda" },
            { title: "Tambahan :", data: "Tambahan" },
            { title: "Rincian :", data: "Rincian" },
            { title: "Bayar :", data: "Bayar" },
            { title: "Dapat PIP :", data: "Dapat_PIP" },
            { title: "Saldo PIP :", data: "Saldo_PIP" },
            { title: "Sisa PIP :", data: "Sisa_PIP" },
            { title: "Angkatan :", data: "Angkatan" },
            { title: "Status :", data: "Status" },
            { title: "Keterangan Mutasi :", data: "Ket_Mutasi" },
            { title: "Pernah Tidak Naik :", data: "Pernah_Tidak_Naik" },
            { title: "Pemotongan :", data: "Pemotongan" },
            { title: "Keterangan :", data: "Ket_Pem" },
            {
                title: "Aksi",
                data: null,
                render: function(data, type, row) {
                    return `
                        <button class="btn btn-primary btn-sm" onclick="editRow('${row.ID}')">
                            <i class="fa-solid fa-pen-to-square"></i>
                        </button>
                        <button class="btn btn-danger btn-sm" onclick="deleteRow('${row.ID}')">
                            <i class="fas fa-trash"></i>
                        </button>
                    `;
                }
            }
        ],
                language: {
    search: "Cari:" // Mengganti label Search dengan Cari
  },
        destroy: true,
        responsive: true,
        select: true,
        stateSave: true,
        ordering: true,
        order: [[0, 'desc']],
        pageLength: 5,
        lengthMenu: [
            [5, 10, 25, 50, 100, -1],
            ['5', '10', '25', '50', '100', 'All']
        ],
        columnDefs: [
            {
                targets: [1, 2, 29], // Adjusted to correct number of columns
                className: 'all'
            },
            {
                targets: [0],
                visible: false, // Hide the first column (ID)
                searchable: true
            }
        ]
    });
}


            function updateTable() {
            // Update table data based on selected class
            const selectedClass = document.getElementById('classDropdown').value;
            // Implement table data updating logic based on selectedClass
        }

        document.getElementById('exportButton').addEventListener('click', function() {
            const table = document.getElementById('dataTable');
            const wb = XLSX.utils.book_new();
            const ws = XLSX.utils.table_to_sheet(table, { raw: true });

            // Check for hidden columns and include them in the sheet
            const cols = Array.from(table.querySelectorAll('thead th')).map(th => th.innerText);
            const rows = Array.from(table.querySelectorAll('tbody tr')).map(tr => 
                Array.from(tr.querySelectorAll('td')).map(td => td.innerText)
            );

            // Create a full data array with header
            const fullData = [cols].concat(rows);

            // Convert the data to a sheet including hidden columns
            const fullSheet = XLSX.utils.aoa_to_sheet(fullData);

            // Add the sheet to the workbook
            XLSX.utils.book_append_sheet(wb, fullSheet, 'Sheet1');

            // Generate Excel file
            const wbout = XLSX.write(wb, { bookType: 'xlsx', type: 'binary' });

            function s2ab(s) {
                const buf = new ArrayBuffer(s.length);
                const view = new Uint8Array(buf);
                for (let i = 0; i < s.length; i++) view[i] = s.charCodeAt(i) & 0xFF;
                return buf;
            }

            // Save the file
            saveAs(new Blob([s2ab(wbout)], { type: "application/octet-stream" }), 'data.xlsx');
        });
        function submitUpdate() {
    var formData = new FormData(document.getElementById('updateForm'));
    var data = {};
    formData.forEach((value, key) => { data[key] = value; });

    const urlEncodedData = new URLSearchParams(data).toString();

    fetch('https://script.google.com/macros/s/AKfycbwk6rBZ-rXkqtJTJe3bk6XNtPHTBqw5BPccTAJb7-0CWFz8ntRc0WPhUNfDDk6xetdfbA/exec', {
    method: 'POST',
    headers: {
        'Content-Type': 'application/x-www-form-urlencoded'
    },
    body: `action=Update&sh=Data&${urlEncodedData}`
    })

    .then(response => response.text())
    .then(result => {
        console.log(result);
        $('#updateModal').modal('hide');
    })
    .catch(error => console.error('Error:', error));
}

function deleteRow(id) {
    const password = prompt("Masukkan sandi untuk menghapus data:");

    if (password === "170899") {
        $.ajax({
    url: 'https://script.google.com/macros/s/AKfycbwk6rBZ-rXkqtJTJe3bk6XNtPHTBqw5BPccTAJb7-0CWFz8ntRc0WPhUNfDDk6xetdfbA/exec',
    type: 'GET',
    data: {
        action: 'Delete',
        id: id,
        sh: 'Data'
    },
  success: function(response) {
    console.log('Response:', response);
    if (typeof response === 'string') {
      // Assuming response is plain text; if JSON, use JSON.parse(response)
      console.log(response);
    }
    $("#dataTable").DataTable().ajax.reload(); // Refresh the table
  },
  error: function(xhr, status, error) {
    console.error('Error deleting data:', error);
    console.log('XHR:', xhr);
    console.log('Status:', status);
    console.log('Response:', xhr.responseText);
  }
});
    } else {
        alert("Sandi salah. Penghapusan data dibatalkan.");
    }
}

function editRow(id) {
    const password = prompt("Masukkan sandi untuk mengedit data:");

    if (password === "1708") { // Ganti "1708" dengan sandi yang sebenarnya
        var table = $("#dataTable").DataTable();
        var rowData = table.rows().data().filter(function(row) {
            return row.ID == id;
        })[0]; // Ambil data baris yang sesuai dengan ID

        if (rowData) {
            // Jika data ditemukan, tampilkan modal dan isi form dengan data yang sesuai
            // Show the modal
                $("#myModal").modal("show");

                // Set values for each input field in the modal
                $("#ID").val(rowData.ID || '');
                $("#Nama").val(rowData.Nama || '');
                $("#Kelas").val(rowData.Kelas || '');
                $("#PPDB").val(rowData.PPDB || '');
                $("#LKS_Ga_7").val(rowData.LKS_Ga_7 || '');
                $("#LKS_Ge_7").val(rowData.LKS_Ge_7 || '');
                $("#Smst_Ga_7").val(rowData.Smst_Ga_7 || '');
                $("#Smst_Ge_7").val(rowData.Smst_Ge_7 || '');
                $("#LKS_Ga_8").val(rowData.LKS_Ga_8 || '');
                $("#LKS_Ge_8").val(rowData.LKS_Ge_8 || '');
                $("#Smst_Ga_8").val(rowData.Smst_Ga_8 || '');
                $("#Smst_Ge_8").val(rowData.Smst_Ge_8 || '');
                $("#LKS_Ga_9").val(rowData.LKS_Ga_9 || '');
                $("#LKS_Ge_9").val(rowData.LKS_Ge_9 || '');
                $("#Smst_Ga_9").val(rowData.Smst_Ga_9 || '');
                $("#AM").val(rowData.AM || '');
                $("#Wisuda").val(rowData.Wisuda || '');
                $("#Tambahan").val(rowData.Tambahan || '');
                $("#Rincian").val(rowData.Rincian || '');
                $("#Bayar").val(rowData.Bayar || '');
                $("#Dapat_PIP").val(rowData.Dapat_PIP || '');
                $("#Saldo_PIP").val(rowData.Saldo_PIP || '');
                $("#Sisa_PIP").val(rowData.Sisa_PIP || '');
                $("#Angkatan").val(rowData.Angkatan || '');
                $("#Status").val(rowData.Status || '');
                $("#Ket_Mutasi").val(rowData.Ket_Mutasi || '');
                $("#Pernah_Tidak_Naik").val(rowData.Pernah_Tidak_Naik || '');
                $("#Pemotongan").val(rowData.Pemotongan || '');
                $("#Ket_Pem").val(rowData.Ket_Pem || '');
        } else {
            console.error('Data not found for ID:', id);
        }
    } else {
        // Jika sandi salah, tampilkan peringatan dan jangan tampilkan modal
        alert("Sandi salah, Anda tidak dapat mengedit data ini.");
    }
}


        
    
        function Jumlahkan() {
            var table = document.getElementById("dataTable");
            var total = 0;
    
            for (var i = 1; i < table.rows.length; i++) {
                var cellValue = parseFloat(table.rows[i].cells[19].innerText); // Assuming the 20th column contains numeric values
                if (!isNaN(cellValue)) {
                    total += cellValue;
                }
            }
    
            var formattedTotal = "Rp " + total.toLocaleString('id-ID');
            document.getElementById("TotalSemua").innerText = ": " + formattedTotal;
        }
    
    $(document).ready(function() {
    onReload();
    
            $('#myForm').on('submit', function(e) {
            e.preventDefault(); // Prevent the default form submission

            // Collect values from the form inputs
            var id = $('#ID').val();
            var nama = $('#Nama').val();
            var ppdb = $('#PPDB').val();
            var kelas = $('#Kelas').val();
            var lksGa7 = $('#LKS_Ga_7').val();
            var lksGe7 = $('#LKS_Ge_7').val();
            var smstGa7 = $('#Smst_Ga_7').val();
            var smstGe7 = $('#Smst_Ge_7').val();
            var lksGa8 = $('#LKS_Ga_8').val();
            var lksGe8 = $('#LKS_Ge_8').val();
            var smstGa8 = $('#Smst_Ga_8').val();
            var smstGe8 = $('#Smst_Ge_8').val();
            var lksGa9 = $('#LKS_Ga_9').val();
            var lksGe9 = $('#LKS_Ge_9').val();
            var smstGa9 = $('#Smst_Ga_9').val();
            var am = $('#AM').val();
            var wisuda = $('#Wisuda').val();
            var Tambahan = $('#Tambahan').val();
            var rincian = $('#Rincian').val();
            var bayar = $('#Bayar').val();
            var dapatPip = $('#Dapat_PIP').val();
            var saldoPip = $('#Saldo_PIP').val();
            var sisaPip = $('#Sisa_PIP').val();
            var angkatan = $('#Angkatan').val();
            var status = $('#Status').val();
            var ketMutasi = $('#Ket_Mutasi').val();
            var pernahTidakNaik = $('#Pernah_Tidak_Naik').val();
            var pemotongan = $('#Pemotongan').val();
            var ketPem = $('#Ket_Pem').val();

        // Log form data for debugging
            console.log('Form data:', {
                ID: id,
                Nama: nama,
                PPDB: ppdb,
                Kelas: kelas,
                LKS_Ga_7: lksGa7,
                LKS_Ge_7: lksGe7,
                Smst_Ga_7: smstGa7,
                Smst_Ge_7: smstGe7,
                LKS_Ga_8: lksGa8,
                LKS_Ge_8: lksGe8,
                Smst_Ga_8: smstGa8,
                Smst_Ge_8: smstGe8,
                LKS_Ga_9: lksGa9,
                LKS_Ge_9: lksGe9,
                Smst_Ga_9: smstGa9,
                AM: am,
                Wisuda: wisuda,
                Tambahan: Tambahan,
                Rincian: rincian,
                Bayar: bayar,
                Saldo_PIP: saldoPip,
                Sisa_PIP: sisaPip,
                Angkatan: angkatan,
                Status: status,
                Ket_Mutasi: ketMutasi,
                Pernah_Tidak_Naik: pernahTidakNaik,
                Dapat_PIP: dapatPip,
                Pemotongan: pemotongan,
                Ket_Pem: ketPem,
                
            });

            $.ajax({
                url: 'https://script.google.com/macros/s/AKfycbwk6rBZ-rXkqtJTJe3bk6XNtPHTBqw5BPccTAJb7-0CWFz8ntRc0WPhUNfDDk6xetdfbA/exec?action=FetchData', // Update with your URL
                type: 'POST', // Or 'GET' based on your API design
                data: {
                    action: 'Update', // Indicate the action to perform
                    ID: id,
                    Nama: nama,
                    PPDB: ppdb,
                    Kelas: kelas,
                    LKS_Ga_7: lksGa7,
                    LKS_Ge_7: lksGe7,
                    Smst_Ga_7: smstGa7,
                    Smst_Ge_7: smstGe7,
                    LKS_Ga_8: lksGa8,
                    LKS_Ge_8: lksGe8,
                    Smst_Ga_8: smstGa8,
                    Smst_Ge_8: smstGe8,
                    LKS_Ga_9: lksGa9,
                    LKS_Ge_9: lksGe9,
                    Smst_Ga_9: smstGa9,
                    AM: am,
                    Wisuda: wisuda,
                    Tambahan: Tambahan,
                    Rincian: rincian,
                    Bayar: bayar,
                    Dapat_PIP: dapatPip,
                    Saldo_PIP: saldoPip,
                    Sisa_PIP: sisaPip,
                    Angkatan: angkatan,
                    Status: status,
                    Ket_Mutasi: ketMutasi,
                    Pernah_Tidak_Naik: pernahTidakNaik,
                    Pemotongan: pemotongan,
                    Ket_Pem: ketPem,
                    sh: 'Data' // Adjust this to your specific sheet name if necessary
                },
                success: function(response) {
                    console.log('Data successfully updated');
                    $("#myModal").modal("hide"); // Close the modal
                    $("#dataTable").DataTable().ajax.reload(); // Refresh the table
                },
                error: function(xhr, status, error) {
                    console.error('Error updating data:', error);
                }
            });
        });
    });
                // Event listener untuk dropdown filter
                $(document).ready(function() {
    const table = $('#dataTable').DataTable();
    $('#classDropdown').change(function() {
                var val = $(this).val();
                table.column(2).search(val === "Semua" ? '' : val).draw();
            });
        });
        
    </script>
    

  </body>
</html>
